

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Awareness Architecture &mdash; Zisoft Awareness 3.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ZiSoft Awareness HW Sizing" href="../sizing/sizing.html" />
    <link rel="prev" title="Initial Configuration" href="../admin_guide/admin_guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Zisoft Awareness
          

          
          </a>

          
            
            
              <div class="version">
                3.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Awareness Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/getting_started.html">Awareness Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Installation Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Admin Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html">Initial Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#training-campaign">Training Campaign</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#email-server-settings">Email Server Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#phishing">Phishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#background-job">Background Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#certificate-configuration">Certificate Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#importing-users-data-from-csv-file">Importing Users Data from CSV file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#importing-users-data-from-ldap-server">Importing Users Data from LDAP Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#periodic-events">Periodic Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#reporting">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#single-sign-on-sso">Single Sign On (SSO)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/admin_guide.html#force-reset-password-forgot-password">Force Reset Password / Forgot Password</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Awareness Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#web-server">Web Server :</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ui-server-angular">UI Server ( Angular ) :</a></li>
<li class="toctree-l2"><a class="reference internal" href="#web-application-server-laravel">Web Application Server ( Laravel) :</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analytics-server-metabase">Analytics server  ( Metabase ) :</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cron-server">Cron server :</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database-server-mariadb">Database Server ( MariaDB) :</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#awareness-ha-deployment">Awareness HA Deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nfs-rhel-centos-debian-ubuntu">NFS: RHEL/CentOS/ Debian/Ubuntu</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nfs-services">NFS Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="#important-files-for-nfs-configuration">Important Files for NFS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup-and-configure-nfs-mounts-on-linux-server">Setup and Configure NFS Mounts on Linux Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing-nfs-server-and-nfs-client">Installing NFS Server and NFS Client</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-the-nfs-server">Setting Up the NFS Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configure-export-directory">Configure Export directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nfs-options">NFS Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-the-nfs-client">Setting Up the NFS Client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mount-shared-directories-on-nfs-client">Mount Shared Directories on NFS Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mount-shared-nfs-directory">Mount Shared NFS Directory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#test-the-working-of-nfs-setup">Test the Working of NFS Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#at-the-nfsserver-end">At the nfsserver end</a></li>
<li class="toctree-l4"><a class="reference internal" href="#at-the-nfsclient-end">At the nfsclient end</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#removing-the-nfs-mount">Removing the NFS Mount</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#important-commands-for-nfs">Important commands for NFS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-swarm-cluster">Create a swarm Cluster</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#init-swarm-manager-node">Init Swarm Manager Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-nodes-to-the-swarm">Add nodes to the swarm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clone-zisoft-awareness-project">Clone Zisoft awareness  project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-zisoft-awareness-offline-project">Deploy Zisoft awareness offline project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#awareness-offline-deployment">Awareness Offline Deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extract-zisoft-xxxxxxx-zip-file">Extract zisoft-xxxxxxx.Zip file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-zisoft-awareness-docker-images">Load Zisoft awareness docker images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Deploy Zisoft awareness offline project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#awareness-smtp-server">Awareness SMTP Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-docker-compose-environment">Create a docker-compose environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#start-container">Start Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-your-mail-accounts">Create your mail accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generate-dkim-keys">Generate DKIM keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restart-and-update-the-container">Restart and update the container</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spf-forwarding-problems">SPF/Forwarding Problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples-with-just-the-relevant-environmental-variables">Examples with just the relevant environmental variables:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#general">General</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dms-debug">DMS_DEBUG</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-clamav">ENABLE_CLAMAV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#one-dir">ONE_DIR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-pop3">ENABLE_POP3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-fail2ban">ENABLE_FAIL2BAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smtp-only">SMTP_ONLY</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ssl-type">SSL_TYPE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tls-level">TLS_LEVEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spoof-protection">SPOOF_PROTECTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-srs">ENABLE_SRS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#permit-docker">PERMIT_DOCKER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#virusmails-delete-delay">VIRUSMAILS_DELETE_DELAY</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-postfix-virtual-transport">ENABLE_POSTFIX_VIRTUAL_TRANSPORT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postfix-dagent">POSTFIX_DAGENT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postfix-mailbox-size-limit">POSTFIX_MAILBOX_SIZE_LIMIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-quotas">ENABLE_QUOTAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postfix-message-size-limit">POSTFIX_MESSAGE_SIZE_LIMIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-managesieve">ENABLE_MANAGESIEVE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#override-hostname">OVERRIDE_HOSTNAME</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postmaster-address">POSTMASTER_ADDRESS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postscreen-action">POSTSCREEN_ACTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dovecot-mailbox-format">DOVECOT_MAILBOX_FORMAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postfix-inet-protocols">POSTFIX_INET_PROTOCOLS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reports">Reports</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pflogsumm-trigger">PFLOGSUMM_TRIGGER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pflogsumm-recipient">PFLOGSUMM_RECIPIENT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pflogsumm-sender">PFLOGSUMM_SENDER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logwatch-interval">LOGWATCH_INTERVAL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logwatch-recipient">LOGWATCH_RECIPIENT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#report-recipient-deprecated">REPORT_RECIPIENT (deprecated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#report-sender-deprecated">REPORT_SENDER (deprecated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#report-interval-deprecated">REPORT_INTERVAL (deprecated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logrotate-interval">LOGROTATE_INTERVAL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#spamassassin">Spamassassin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enable-spamassassin">ENABLE_SPAMASSASSIN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spamassassin-spam-to-inbox">SPAMASSASSIN_SPAM_TO_INBOX</a></li>
<li class="toctree-l3"><a class="reference internal" href="#move-spam-to-junk">MOVE_SPAM_TO_JUNK</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sa-tag">SA_TAG</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sa-tag2">SA_TAG2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sa-kill">SA_KILL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sa-spam-subject">SA_SPAM_SUBJECT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sa-shortcircuit-bayes-spam">SA_SHORTCIRCUIT_BAYES_SPAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sa-shortcircuit-bayes-ham">SA_SHORTCIRCUIT_BAYES_HAM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fetchmail">Fetchmail</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enable-fetchmail">ENABLE_FETCHMAIL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetchmail-poll">FETCHMAIL_POLL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ldap">LDAP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enable-ldap">ENABLE_LDAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-start-tls">LDAP_START_TLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-server-host">LDAP_SERVER_HOST</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-search-base">LDAP_SEARCH_BASE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-bind-dn">LDAP_BIND_DN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-bind-pw">LDAP_BIND_PW</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-query-filter-user">LDAP_QUERY_FILTER_USER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-query-filter-group">LDAP_QUERY_FILTER_GROUP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-query-filter-alias">LDAP_QUERY_FILTER_ALIAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-query-filter-domain">LDAP_QUERY_FILTER_DOMAIN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dovecot-tls">DOVECOT_TLS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dovecot">Dovecot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dovecot-user-filter">DOVECOT_USER_FILTER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dovecot-user-attrs">DOVECOT_USER_ATTRS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dovecot-pass-filter">DOVECOT_PASS_FILTER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dovecot-pass-attrs">DOVECOT_PASS_ATTRS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#postgrey">Postgrey</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enable-postgrey">ENABLE_POSTGREY</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postgrey-delay">POSTGREY_DELAY</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postgrey-max-age">POSTGREY_MAX_AGE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postgrey-auto-whitelist-clients">POSTGREY_AUTO_WHITELIST_CLIENTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postgrey-text">POSTGREY_TEXT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sasl-auth">SASL Auth</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enable-saslauthd">ENABLE_SASLAUTHD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-mechanisms">SASLAUTHD_MECHANISMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-mech-options">SASLAUTHD_MECH_OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-ldap-server">SASLAUTHD_LDAP_SERVER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-ldap-ssl">SASLAUTHD_LDAP_SSL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-ldap-bind-dn">SASLAUTHD_LDAP_BIND_DN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-ldap-password">SASLAUTHD_LDAP_PASSWORD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-ldap-search-base">SASLAUTHD_LDAP_SEARCH_BASE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saslauthd-ldap-filter">SASLAUTHD_LDAP_FILTER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sasl-passwd">SASL_PASSWD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#srs-sender-rewriting-scheme">SRS (Sender Rewriting Scheme)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#srs-sender-classes">SRS_SENDER_CLASSES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#srs-exclude-domains">SRS_EXCLUDE_DOMAINS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#srs-secret">SRS_SECRET</a></li>
<li class="toctree-l3"><a class="reference internal" href="#srs-domainname">SRS_DOMAINNAME</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#default-relay-host">Default Relay Host</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">DEFAULT_RELAY_HOST</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#multi-domain-relay-hosts">Multi-domain Relay Hosts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#relay-host">RELAY_HOST</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relay-port">RELAY_PORT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relay-user">RELAY_USER</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relay-password">RELAY_PASSWORD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sizing/sizing.html"><strong>ZiSoft Awareness HW Sizing</strong></a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Zisoft Awareness</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Awareness Architecture</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Deployment/deployment.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>Deployment</p>
<div class="section" id="awareness-architecture">
<h1>Awareness Architecture<a class="headerlink" href="#awareness-architecture" title="Permalink to this headline">¶</a></h1>
<p><img alt="https://zisoft-public.s3-eu-west-1.amazonaws.com/zisoft.vpd+(1).png" src="https://zisoft-public.s3-eu-west-1.amazonaws.com/zisoft.vpd+(1).png" /></p>
<div class="section" id="web-server">
<h2>Web Server :<a class="headerlink" href="#web-server" title="Permalink to this headline">¶</a></h2>
<p>Web Server has focused on high performance, high concurrency and low memory usage web server functionality, like load balancing, caching, access and bandwidth control, and the ability to integrate efficiently with a variety of applications</p>
<ol class="simple">
<li>HTTP Handler</li>
<li>Serving Static Content</li>
<li>Web Server Reverse Proxy</li>
<li>Web Server Content Caching</li>
<li>Compression and Decompression</li>
<li>Secure Connect with SSL CA</li>
</ol>
</div>
<div class="section" id="ui-server-angular">
<h2>UI Server ( Angular ) :<a class="headerlink" href="#ui-server-angular" title="Permalink to this headline">¶</a></h2>
<p>Frontend  part of the application that users can see and interact with directly in order to receive the backend capabilities of the system. It involves everything that the user can see, touch and experience.</p>
</div>
<div class="section" id="web-application-server-laravel">
<h2>Web Application Server ( Laravel) :<a class="headerlink" href="#web-application-server-laravel" title="Permalink to this headline">¶</a></h2>
<p>Laravel is a web application framework with expressive, elegant syntax. … Laravel attempts to take the pain out of development by easing common tasks used in the majority of web projects, such as authentication, routing, sessions, and caching</p>
<ul class="simple">
<li>AUTHORIZATION TECHNIQUE :
Laravel  provides a simple way to organize authorization logic and control access to resources.</li>
<li>OBJECT-ORIENTED LIBRARIES :
pre-installed libraries to implement  many advanced features, such as checking active users,                     Bcrypt hashing, password reset, CSRF (Cross-site Request Forgery) protection, and encryption.</li>
</ul>
<p>-ARTISAN :
Developer has to usually interact with the Laravel framework using a command line that creates and handles the Laravel project environment.
-MVC SUPPORT :
Supports MVC Architecture ensuring clarity between logic and presentation. MVC helps in improving the performance, allows better documentation, and has multiple built-in functionalities.</p>
<p>-SECURITY :
Ues Bcrypt hashing algorithm for generating an encrypted representation of a password. Laravel uses prepared SQL statements which make injection attacks unimaginable. Along with this, Laravel provides a simple way to escape user input to avoid user injection of  tag.
-SSO Integration :
One-click sign-in: Allows collaborators to sign in from your SSO provider without maintaining a separate username and password.
Automatic provisioning: Allows authorized users to create account when they require access.</p>
<p>-LDAP Integration :
LDAP integration allows your instance to use your existing LDAP server as the master source of user data.Administrators integrate with a Lightweight Directory Access Protocol (LDAP) directory to streamline the user login process and to automate administrative tasks such as creating users and assigning them role</p>
</div>
<div class="section" id="analytics-server-metabase">
<h2>Analytics server  ( Metabase ) :<a class="headerlink" href="#analytics-server-metabase" title="Permalink to this headline">¶</a></h2>
<p>Analyzing data and presenting actionable information which helps executives, managers and other corporate users make informed training/phishing decisions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>  <span class="n">BI</span> <span class="p">:</span> <span class="n">information</span> <span class="n">management</span> <span class="n">tool</span> <span class="n">that</span> <span class="ow">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">track</span> <span class="n">KPIs</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">key</span> <span class="n">data</span> <span class="n">points</span> <span class="n">relevant</span> <span class="n">to</span> <span class="n">a</span> <span class="n">business</span><span class="p">,</span> <span class="n">department</span><span class="p">,</span> <span class="ow">or</span> <span class="n">specific</span> <span class="n">process</span><span class="o">.</span> <span class="n">Through</span> <span class="n">the</span> <span class="n">use</span> <span class="n">of</span> <span class="n">data</span> <span class="n">visualizations</span><span class="p">,</span> <span class="n">dashboards</span> <span class="n">simplify</span> <span class="nb">complex</span> <span class="n">data</span> <span class="n">sets</span> <span class="n">to</span> <span class="n">provide</span> <span class="n">users</span> <span class="k">with</span> <span class="n">at</span> <span class="n">a</span> <span class="n">glance</span> <span class="n">awareness</span> <span class="n">of</span> <span class="n">current</span> <span class="n">performance</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="cron-server">
<h2>Cron server :<a class="headerlink" href="#cron-server" title="Permalink to this headline">¶</a></h2>
<p>Laravel command scheduler allows for the fluent and expressive defining of command schedule within Laravel itself, and only a single Cron entry is needed on the server</p>
</div>
<div class="section" id="database-server-mariadb">
<h2>Database Server ( MariaDB) :<a class="headerlink" href="#database-server-mariadb" title="Permalink to this headline">¶</a></h2>
<p>MariaDB   open source relational database management system (DBMS) that is a compatible drop-in replacement for the widely used MySQL database technology.
MariaDB sports faster and safer replication with updates being up to 2x faster than with traditional MySQL Replication setups. … MariaDB replication is backward compatible with MySQL servers,</p>
</div>
</div>
<div class="section" id="awareness-ha-deployment">
<h1>Awareness HA Deployment<a class="headerlink" href="#awareness-ha-deployment" title="Permalink to this headline">¶</a></h1>
<div class="section" id="nfs-rhel-centos-debian-ubuntu">
<h2>NFS: RHEL/CentOS/ Debian/Ubuntu<a class="headerlink" href="#nfs-rhel-centos-debian-ubuntu" title="Permalink to this headline">¶</a></h2>
<p>==============================================================================</p>
<ol class="simple">
<li><strong>NFS</strong> allows local access to remote files.</li>
<li>It uses standard <strong>client</strong>/<strong>server</strong> architecture for file sharing
between all *<strong>nix</strong> based machines.</li>
<li>With <strong>NFS</strong> it is not necessary that both machines run on the same
<strong>OS</strong>.</li>
</ol>
<p><img alt="https://awareness-docs.s3.us-east-2.amazonaws.com/_static/images/nfs.png" src="https://awareness-docs.s3.us-east-2.amazonaws.com/_static/images/nfs.png" />
4.  With the help of <strong>NFS</strong> we can configure <strong>centralized storage</strong>
solutions.
5.  Users get their <strong>data</strong> irrespective of physical location.
6.  No manual <strong>refresh</strong> needed for new files.
7.  Newer version of <strong>NFS</strong> also supports <strong>acl</strong>, <strong>pseudo</strong> root
mounts.
8.  Can be secured with <strong>Firewalls</strong> and <strong>Kerberos</strong>.</p>
<div class="section" id="nfs-services">
<h3>NFS Services<a class="headerlink" href="#nfs-services" title="Permalink to this headline">¶</a></h3>
<p>Its a <strong>System V-launched</strong> service. The <strong>NFS</strong> server package includes
three facilities, included in the <strong>portmap</strong> and <strong>nfs-utils</strong>
packages.</p>
<ol class="simple">
<li><strong>portmap</strong> : It maps calls made from other machines to the correct
<strong>RPC</strong> service (not required with <strong>NFSv4</strong>).</li>
<li><strong>nfs</strong>: It translates remote <strong>file sharing</strong> requests into
requests on the local file system.</li>
<li><strong>rpc.mountd</strong>: This service is responsible for <strong>mounting</strong> and
<strong>unmounting</strong> of file systems.</li>
</ol>
</div>
<div class="section" id="important-files-for-nfs-configuration">
<h3>Important Files for NFS Configuration<a class="headerlink" href="#important-files-for-nfs-configuration" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><strong>/etc/exports</strong> : Its a main configuration file of <strong>NFS</strong>, all
exported <strong>files</strong> and <strong>directories</strong> are defined in this file at
the <strong>NFS Server</strong> end.</li>
<li><strong>/etc/fstab</strong> : To mount a <strong>NFS directory</strong> on your system across
the <strong>reboots</strong>, we need to make an entry in <strong>/etc/fstab</strong>.</li>
<li><strong>/etc/sysconfig/nfs</strong> : Configuration file of <strong>NFS</strong> to control on
which port <strong>rpc</strong> and other services are <strong>listening</strong>.</li>
</ol>
</div>
<div class="section" id="setup-and-configure-nfs-mounts-on-linux-server">
<h3>Setup and Configure NFS Mounts on Linux Server<a class="headerlink" href="#setup-and-configure-nfs-mounts-on-linux-server" title="Permalink to this headline">¶</a></h3>
<p>To setup <strong>NFS</strong> mounts, we’ll be needing at least two
<strong>Linux</strong>/<strong>Unix</strong> machines. Here in this tutorial, I’ll be using two
servers.</p>
<ol class="simple">
<li><strong>NFS Server</strong>: nfsserver.example.com with IP-<strong>192.168.0.100</strong></li>
<li><strong>NFS Client</strong> : nfsclient.example.com with IP-<strong>192.168.0.101</strong></li>
</ol>
<div class="section" id="installing-nfs-server-and-nfs-client">
<h4>Installing NFS Server and NFS Client<a class="headerlink" href="#installing-nfs-server-and-nfs-client" title="Permalink to this headline">¶</a></h4>
<p>We need to install <strong>NFS</strong> packages on our <strong>NFS Server</strong> as well as on
<strong>NFS Client</strong> machine. We can install it via “<strong>yum</strong>” (<strong>Red Hat</strong>
Linux) and “<strong>apt-get</strong>” (<strong>Debian</strong> and <strong>Ubuntu</strong>) package installers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># yum install nfs-utils nfs-utils-lib</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># yum install portmap (not required with NFSv4)</span>

<span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># apt-get install nfs-utils nfs-utils-lib</span>
</pre></div>
</div>
<p>Now start the <strong>services</strong> on both machines.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># /etc/init.d/portmap start</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># /etc/init.d/nfs start</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># chkconfig --level 35 portmap on</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># chkconfig --level 35 nfs on</span>
</pre></div>
</div>
<p>After installing packages and starting services on both the machines, we
need to configure both the machines for file sharing.</p>
</div>
</div>
<div class="section" id="setting-up-the-nfs-server">
<h3>Setting Up the NFS Server<a class="headerlink" href="#setting-up-the-nfs-server" title="Permalink to this headline">¶</a></h3>
<p>First we will be configuring the <strong>NFS</strong> server.</p>
<div class="section" id="configure-export-directory">
<h4>Configure Export directory<a class="headerlink" href="#configure-export-directory" title="Permalink to this headline">¶</a></h4>
<p>For sharing a directory with <strong>NFS</strong>, we need to make an entry in
“<strong>/etc/exports</strong>” configuration file. Here I’ll be creating a new
directory named “<strong>nfsshare</strong>” in “<strong>/</strong>” partition to share with
<strong>client server</strong>, you can also share an already existing directory with
NFS.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># mkdir /nfsshare</span>
</pre></div>
</div>
<p>Now we need to make an entry in “<strong>/etc/exports</strong>” and <strong>restart</strong> the
services to make our directory shareable in the network.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># vi /etc/exports</span>

<span class="o">/</span><span class="n">nfsshare</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.101</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">sync</span><span class="p">,</span><span class="n">no_root_squash</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above example, there is a directory in <strong>/</strong> partition named
“<strong>nfsshare</strong>” is being shared with client IP “<strong>192.168.0.101</strong>” with
<strong>read</strong> and <strong>write</strong> (<strong>rw</strong>) privilege, you can also use <strong>hostname</strong>
of the client in the place of <strong>IP</strong> in above example.</p>
</div>
<div class="section" id="nfs-options">
<h4>NFS Options<a class="headerlink" href="#nfs-options" title="Permalink to this headline">¶</a></h4>
<p>Some other options we can use in “<strong>/etc/exports</strong>” file for file
sharing is as follows.</p>
<ol class="simple">
<li><strong>ro</strong>: With the help of this option we can provide <strong>read only
access</strong> to the shared files i.e <strong>client</strong> will only be able to
<strong>read</strong>.</li>
<li><strong>rw</strong>: This option allows the <strong>client server</strong> to both <strong>read</strong>
and <strong>write</strong> access within the shared directory.</li>
<li><strong>sync</strong>: Sync confirms requests to the shared directory only once
the <strong>changes</strong> have been committed.</li>
<li><strong>no_subtree_check</strong>: This option prevents the <strong>subtree</strong>
checking. When a shared directory is the subdirectory of a larger
file system, <strong>nfs</strong> performs scans of every directory above it, in
order to verify its permissions and details. Disabling the
<strong>subtree</strong> check may increase the reliability of <strong>NFS</strong>, but
reduce <strong>security</strong>.</li>
<li><strong>no_root_squash</strong>: This phrase allows <strong>root</strong> to <strong>connect</strong> to
the designated directory.</li>
</ol>
<p>For more options with “<strong>/etc/exports</strong>“, you are recommended to read
the <strong>man pages</strong> for <strong>export</strong>.</p>
</div>
</div>
<div class="section" id="setting-up-the-nfs-client">
<h3>Setting Up the NFS Client<a class="headerlink" href="#setting-up-the-nfs-client" title="Permalink to this headline">¶</a></h3>
<p>After configuring the <strong>NFS</strong> server, we need to <strong>mount</strong> that shared
directory or partition in the <strong>client</strong> server.</p>
<div class="section" id="mount-shared-directories-on-nfs-client">
<h4>Mount Shared Directories on NFS Client<a class="headerlink" href="#mount-shared-directories-on-nfs-client" title="Permalink to this headline">¶</a></h4>
<p>Now at the <strong>NFS client</strong> end, we need to <strong>mount</strong> that directory in
our server to access it locally. To do so, first we need to find out
that shares available on the remote server or NFS Server.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsclient</span> <span class="o">~</span><span class="p">]</span><span class="c1"># showmount -e 192.168.0.100</span>

<span class="n">Export</span> <span class="nb">list</span> <span class="k">for</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.100</span><span class="p">:</span>
<span class="o">/</span><span class="n">nfsshare</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.101</span>
</pre></div>
</div>
<p>Above command shows that a directory named “<strong>nfsshare</strong>” is available
at “<strong>192.168.0.100</strong>” to share with your server.</p>
</div>
<div class="section" id="mount-shared-nfs-directory">
<h4>Mount Shared NFS Directory<a class="headerlink" href="#mount-shared-nfs-directory" title="Permalink to this headline">¶</a></h4>
<p>To <strong>mount</strong> that shared <strong>NFS</strong> directory we can use following mount
command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsclient</span> <span class="o">~</span><span class="p">]</span><span class="c1"># mount -t nfs 192.168.0.100:/nfsshare /mnt/nfsshare</span>
</pre></div>
</div>
<p>The above command will mount that shared directory in
“<strong>/mnt/nfsshare</strong>” on the client server. You can verify it following
command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsclient</span> <span class="o">~</span><span class="p">]</span><span class="c1"># mount | grep nfs</span>

<span class="n">sunrpc</span> <span class="n">on</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">nfs</span><span class="o">/</span><span class="n">rpc_pipefs</span> <span class="nb">type</span> <span class="n">rpc_pipefs</span> <span class="p">(</span><span class="n">rw</span><span class="p">)</span>
<span class="n">nfsd</span> <span class="n">on</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">fs</span><span class="o">/</span><span class="n">nfsd</span> <span class="nb">type</span> <span class="n">nfsd</span> <span class="p">(</span><span class="n">rw</span><span class="p">)</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">0.100</span><span class="p">:</span><span class="o">/</span><span class="n">nfsshare</span> <span class="n">on</span> <span class="o">/</span><span class="n">mnt</span> <span class="nb">type</span> <span class="n">nfs</span> <span class="p">(</span><span class="n">rw</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.100</span><span class="p">)</span>
</pre></div>
</div>
<p>The above mount command mounted the <strong>nfs shared directory</strong> on to <strong>nfs
client</strong> temporarily, to mount an NFS directory <strong>permanently</strong> on your
system across the <strong>reboots</strong>, we need to make an entry in
“<strong>/etc/fstab</strong>“.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsclient</span> <span class="o">~</span><span class="p">]</span><span class="c1"># vi /etc/fstab</span>
</pre></div>
</div>
<p>Add the following new line as shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.100</span><span class="p">:</span><span class="o">/</span><span class="n">nfsshare</span> <span class="o">/</span><span class="n">mnt</span>  <span class="n">nfs</span> <span class="n">defaults</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="test-the-working-of-nfs-setup">
<h3>Test the Working of NFS Setup<a class="headerlink" href="#test-the-working-of-nfs-setup" title="Permalink to this headline">¶</a></h3>
<p>We can test our <strong>NFS server setup</strong> by creating a <strong>test file</strong> on the
server end and check its availability at <strong>nfs client</strong> side or
vice-versa.</p>
<div class="section" id="at-the-nfsserver-end">
<h4>At the nfsserver end<a class="headerlink" href="#at-the-nfsserver-end" title="Permalink to this headline">¶</a></h4>
<p>I have created a new text file named “<strong>nfstest.txt</strong>’ in that shared
directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsserver</span> <span class="o">~</span><span class="p">]</span><span class="c1"># cat &gt; /nfsshare/nfstest.txt</span>

<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">test</span> <span class="n">file</span> <span class="n">to</span> <span class="n">test</span> <span class="n">the</span> <span class="n">working</span> <span class="n">of</span> <span class="n">NFS</span> <span class="n">server</span> <span class="n">setup</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="at-the-nfsclient-end">
<h4>At the nfsclient end<a class="headerlink" href="#at-the-nfsclient-end" title="Permalink to this headline">¶</a></h4>
<p>Go to that shared directory in <strong>client server</strong> and you’ll find that
shared file without any manual refresh or service restart.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsclient</span><span class="p">]</span><span class="c1"># ll /mnt/nfsshare</span>
<span class="n">total</span> <span class="mi">4</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">61</span> <span class="n">Sep</span> <span class="mi">21</span> <span class="mi">21</span><span class="p">:</span><span class="mi">44</span> <span class="n">nfstest</span><span class="o">.</span><span class="n">txt</span>
<span class="n">root</span><span class="nd">@nfsclient</span> <span class="o">~</span><span class="p">]</span><span class="c1"># cat /mnt/nfsshare/nfstest.txt</span>
<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">test</span> <span class="n">file</span> <span class="n">to</span> <span class="n">test</span> <span class="n">the</span> <span class="n">working</span> <span class="n">of</span> <span class="n">NFS</span> <span class="n">server</span> <span class="n">setup</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="removing-the-nfs-mount">
<h3>Removing the NFS Mount<a class="headerlink" href="#removing-the-nfs-mount" title="Permalink to this headline">¶</a></h3>
<p>If you want to <strong>unmount</strong> that shared directory from your server after
you are done with the file sharing, you can simply <strong>unmount</strong> that
particular directory with “<strong>umount</strong>” command. See this example below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@nfsclient</span> <span class="o">~</span><span class="p">]</span><span class="c1"># umount /mnt/nfsshare</span>
</pre></div>
</div>
<p>You can see that the mounts were removed by then looking at the
filesystem again.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@nfsclient</span> <span class="o">~</span><span class="p">]</span><span class="c1"># df -h -F nfs</span>
</pre></div>
</div>
<p>You’ll see that those shared directories are not available any more.</p>
<div class="section" id="important-commands-for-nfs">
<h4>Important commands for NFS<a class="headerlink" href="#important-commands-for-nfs" title="Permalink to this headline">¶</a></h4>
<p>Some more important commands for <strong>NFS</strong>.</p>
<ol class="simple">
<li><strong>showmount -e</strong> : Shows the available <strong>shares</strong> on your local
machine</li>
<li><strong>showmount -e</strong> <strong>&lt;server-ip or hostname&gt;</strong>: Lists the available
<strong>shares</strong> at the <strong>remote</strong> server</li>
<li><strong>showmount -d</strong> : Lists all the <strong>sub directories</strong></li>
<li><strong>exportfs -v</strong> : Displays a list of shares <strong>files</strong> and
<strong>options</strong> on a server</li>
<li><strong>exportfs -a</strong> : Exports all shares listed in <strong>/etc/exports</strong>, or
given name</li>
<li><strong>exportfs -u</strong> : Unexports all shares listed in <strong>/etc/exports</strong>,
or given name</li>
<li><strong>exportfs -r</strong> : Refresh the server’s list after modifying
<strong>/etc/exports</strong></li>
</ol>
</div>
</div>
</div>
<div class="section" id="create-a-swarm-cluster">
<h2>Create a swarm Cluster<a class="headerlink" href="#create-a-swarm-cluster" title="Permalink to this headline">¶</a></h2>
<p>===========================</p>
<p>After you complete the (https://docs.docker.com/engine/swarm/swarm-tutorial/) steps,
you’re ready to create a swarm. Make sure the Docker Engine daemon is
started on the host machines.</p>
<div class="section" id="init-swarm-manager-node">
<h3>Init Swarm Manager Node<a class="headerlink" href="#init-swarm-manager-node" title="Permalink to this headline">¶</a></h3>
<p>=============================</p>
<ol>
<li><p class="first">Open a terminal and ssh into the machine where you want to run your
manager node. This tutorial uses a machine named
<code class="docutils literal notranslate"><span class="pre">manager1</span></code>. If you use Docker Machine, you can
connect to it via SSH using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker-machine ssh manager1
</pre></div>
</div>
</li>
<li><p class="first">Run the following command to create a new swarm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker swarm init --advertise-addr &lt;MANAGER-IP&gt;
</pre></div>
</div>
<blockquote>
<div><p><strong>Note</strong>: If you are using Docker Desktop for Mac or Docker
Desktop for Windows to test single-node swarm, simply run
<code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">swarm</span> <span class="pre">init</span></code> with no arguments. There
is no need to specify <code class="docutils literal notranslate"><span class="pre">--advertise-addr</span></code> in
this case. To learn more, see the topic on how to <a class="reference external" href="https://docs.docker.com/engine/swarm/swarm-tutorial/#use-docker-for-mac-or-docker-for-windows">Use Docker
Desktop or Mac or Docker Desktop for
Windows</a>
with Swarm.</p>
</div></blockquote>
<p>In the tutorial, the following command creates a swarm on the
<code class="docutils literal notranslate"><span class="pre">manager1</span></code> machine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker swarm init --advertise-addr 192.168.99.100
</pre></div>
</div>
<p>Swarm initialized: current node (dxn1zf6l61qsb1josjja83ngz) is now a manager.</p>
<p>To add a worker to this swarm, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```
$ docker swarm join \
--token SWMTKN-1-49nj1cmql0jkz5s954yi3oex3nedyz0fb0xx14ie39trti4wxv-8vxv8rssmk743ojnwacrr2e7c \
192.168.99.100:2377
```
</pre></div>
</div>
<p>To add a manager to this swarm, run ‘docker swarm join-token manager’ and follow the instructions.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--advertise-addr</span></code> flag configures the
manager node to publish its address as
<code class="docutils literal notranslate"><span class="pre">192.168.99.100</span></code>. The other nodes in the swarm
must be able to access the manager at the IP address.</p>
<p>The output includes the commands to join new nodes to the swarm.
Nodes will join as managers or workers depending on the value for
the <code class="docutils literal notranslate"><span class="pre">--token</span></code> flag.</p>
</li>
<li><p class="first">Run <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">info</span></code> to view the current state of
the swarm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker info

Containers: 2
Running: 0
Paused: 0
Stopped: 2
  ...snip...
Swarm: active
  NodeID: dxn1zf6l61qsb1josjja83ngz
  Is Manager: true
  Managers: 1
  Nodes: 1
  ...snip...
</pre></div>
</div>
</li>
<li><p class="first">Run the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">node</span> <span class="pre">ls</span></code> command to view
information about nodes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker node ls

ID                           HOSTNAME  STATUS  AVAILABILITY  MANAGER STATUS
dxn1zf6l61qsb1josjja83ngz *  manager1  Ready   Active        Leader
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">*</span></code> next to the node ID indicates that
you’re currently connected on this node.</p>
<p>Docker Engine swarm mode automatically names the node for the
machine host name.</p>
</li>
</ol>
</div>
<div class="section" id="add-nodes-to-the-swarm">
<h3>Add nodes to the swarm<a class="headerlink" href="#add-nodes-to-the-swarm" title="Permalink to this headline">¶</a></h3>
<p>=============================</p>
<ol>
<li><p class="first">Open a terminal and ssh into the machine where you want to run a
worker node. This tutorial uses the name
<code class="docutils literal notranslate"><span class="pre">worker1</span></code>.</p>
</li>
<li><p class="first">Run the command produced by the
<code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">swarm</span> <span class="pre">init</span></code> output from the <a class="reference external" href="https://docs.docker.com/engine/swarm/swarm-tutorial/create-swarm/">Create a
swarm</a>
tutorial step to create a worker node joined to the existing swarm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker swarm join \
  --token  SWMTKN-1-49nj1cmql0jkz5s954yi3oex3nedyz0fb0xx14ie39trti4wxv-8vxv8rssmk743ojnwacrr2e7c \
  192.168.99.100:2377
</pre></div>
</div>
<p>This node joined a swarm as a worker.</p>
<p>If you don’t have the command available, you can run the following
command on a manager node to retrieve the join command for a worker:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker swarm join-token worker
</pre></div>
</div>
<p>To add a worker to this swarm, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">docker</span> <span class="n">swarm</span> <span class="n">join</span> \
    <span class="o">--</span><span class="n">token</span> <span class="n">SWMTKN</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">49</span><span class="n">nj1cmql0jkz5s954yi3oex3nedyz0fb0xx14ie39trti4wxv</span><span class="o">-</span><span class="mi">8</span><span class="n">vxv8rssmk743ojnwacrr2e7c</span> \
    <span class="mf">192.168</span><span class="o">.</span><span class="mf">99.100</span><span class="p">:</span><span class="mi">2377</span>
</pre></div>
</div>
</li>
<li><p class="first">Open a terminal and ssh into the machine where you want to run a
second worker node. This tutorial uses the name
<code class="docutils literal notranslate"><span class="pre">worker2</span></code>.</p>
</li>
<li><p class="first">Run the command produced by the
<code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">swarm</span> <span class="pre">init</span></code> output from the <a class="reference external" href="https://docs.docker.com/engine/swarm/swarm-tutorial/create-swarm/">Create a
swarm</a>
tutorial step to create a second worker node joined to the existing
swarm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker swarm join \
  --token SWMTKN-1-49nj1cmql0jkz5s954yi3oex3nedyz0fb0xx14ie39trti4wxv-8vxv8rssmk743ojnwacrr2e7c \
  192.168.99.100:2377
</pre></div>
</div>
</li>
</ol>
<p>This node joined a swarm as a worker.</p>
<ol>
<li><p class="first">Open a terminal and ssh into the machine where the manager node runs
and run the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">node</span> <span class="pre">ls</span></code> command to see the
worker nodes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker node ls

ID                           HOSTNAME  STATUS  AVAILABILITY  MANAGER STATUS
03g1y59jwfg7cf99w4lt0f662    worker2   Ready   Active
9j68exjopxe7wfl6yuxml7a7j    worker1   Ready   Active
dxn1zf6l61qsb1josjja83ngz *  manager1  Ready   Active        Leader
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MANAGER</span></code> column identifies the manager
nodes in the swarm. The empty status in this column for
<code class="docutils literal notranslate"><span class="pre">worker1</span></code> and <code class="docutils literal notranslate"><span class="pre">worker2</span></code>
identifies them as worker nodes.</p>
<p>Swarm management commands like <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">node</span> <span class="pre">ls</span></code>
only work on manager nodes.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="clone-zisoft-awareness-project">
<h2>Clone Zisoft awareness  project<a class="headerlink" href="#clone-zisoft-awareness-project" title="Permalink to this headline">¶</a></h2>
<p>Run the command where /zisoft-ha/ is shared-FS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd /zisoft-ha/
$ git clone https://gitlab.com/zisoft/awareness.git
$ cd awareness
$ zisoft build --docker --sass --app --ui --composer
$ zisoft package
$ zisoft deploy --prod
</pre></div>
</div>
</div>
<div class="section" id="deploy-zisoft-awareness-offline-project">
<h2>Deploy Zisoft awareness offline project<a class="headerlink" href="#deploy-zisoft-awareness-offline-project" title="Permalink to this headline">¶</a></h2>
<p>Run the command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd /zisoft-ha/
$ zisoft deploy --prod
</pre></div>
</div>
</div>
</div>
<div class="section" id="awareness-offline-deployment">
<h1>Awareness Offline Deployment<a class="headerlink" href="#awareness-offline-deployment" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li>Docker swarm mode  active :</li>
</ol>
<p>Run the command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker info
</pre></div>
</div>
<p>Check if swarm mode is active</p>
<p><img alt="https://awareness-docs.s3.us-east-2.amazonaws.com/_static/images/swarm-active.png" src="https://awareness-docs.s3.us-east-2.amazonaws.com/_static/images/swarm-active.png" /></p>
<ol class="simple">
<li>Nodejs, Npm ,Unzip Package installed.</li>
<li>Offline zisoft-xxxxxxx.Zip file downloaded from release artifacts.</li>
</ol>
</div>
<div class="section" id="extract-zisoft-xxxxxxx-zip-file">
<h2>Extract zisoft-xxxxxxx.Zip file<a class="headerlink" href="#extract-zisoft-xxxxxxx-zip-file" title="Permalink to this headline">¶</a></h2>
<p>Run the command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ unzip zisoft-xxxxxxx.zip
</pre></div>
</div>
</div>
<div class="section" id="load-zisoft-awareness-docker-images">
<h2>Load Zisoft awareness docker images<a class="headerlink" href="#load-zisoft-awareness-docker-images" title="Permalink to this headline">¶</a></h2>
<p>Run the command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd zisoft-xxxxxxx
$ zisoft load 
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>Deploy Zisoft awareness offline project<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Run the command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ zisoft deploy --offline
</pre></div>
</div>
</div>
</div>
<div class="section" id="awareness-smtp-server">
<h1>Awareness SMTP Server<a class="headerlink" href="#awareness-smtp-server" title="Permalink to this headline">¶</a></h1>
<p>A fullstack but simple mail server (smtp, imap, antispam, antivirus…).
Only configuration files, no SQL database. Keep it simple and versioned.
Easy to deploy and upgrade.</p>
<ul class="simple">
<li><a class="reference external" href="http://www.postfix.org">Postfix</a> with smtp or ldap auth</li>
<li><a class="reference external" href="https://www.dovecot.org">Dovecot</a> for sasl, imap (and optional pop3) with ssl support, with ldap auth and sieve.</li>
<li>saslauthd with ldap auth</li>
<li><a class="reference external" href="https://www.amavis.org/">Amavis</a></li>
<li><a class="reference external" href="http://spamassassin.apache.org/">Spamassasin</a> supporting custom rules</li>
<li><a class="reference external" href="https://www.clamav.net/">ClamAV</a> with automatic updates</li>
<li><a class="reference external" href="http://www.opendkim.org">OpenDKIM</a></li>
<li><a class="reference external" href="https://github.com/trusteddomainproject/OpenDMARC">OpenDMARC</a></li>
<li><a class="reference external" href="https://www.fail2ban.org/wiki/index.php/Main_Page">Fail2ban</a></li>
<li><a class="reference external" href="http://www.fetchmail.info/fetchmail-man.html">Fetchmail</a></li>
<li><a class="reference external" href="http://www.postfix.org/POSTSCREEN_README.html">Postscreen</a></li>
<li><a class="reference external" href="https://postgrey.schweikert.ch/">Postgrey</a></li>
<li>basic <a class="reference external" href="https://github.com/tomav/docker-mailserver/wiki/Configure-Sieve-filters">Sieve support</a> using dovecot</li>
<li><a class="reference external" href="https://letsencrypt.org/">LetsEncrypt</a> and self-signed certificates</li>
<li>persistent data and state (but think about backups!)</li>
<li><a class="reference external" href="https://hub.docker.com/r/tvial/docker-mailserver/">Automated builds on docker hub</a></li>
<li>Plus addressing (a.k.a. <a class="reference external" href="http://www.postfix.org/postconf.5.html#recipient_delimiter">extension delimiters</a>)
works out of the box: email for <code class="docutils literal notranslate"><span class="pre">you+extension&#64;example.com</span></code> go to <code class="docutils literal notranslate"><span class="pre">you&#64;example.com</span></code></li>
</ul>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Recommended:</p>
<ul class="simple">
<li>1 CPU</li>
<li>1-2GB RAM</li>
<li>Swap enabled for the container</li>
</ul>
<p>Minimum:</p>
<ul class="simple">
<li>1 CPU</li>
<li>512MB RAM</li>
</ul>
<div class="section" id="create-a-docker-compose-environment">
<h3>Create a docker-compose environment<a class="headerlink" href="#create-a-docker-compose-environment" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Edit the files <code class="docutils literal notranslate"><span class="pre">.env</span></code> and <code class="docutils literal notranslate"><span class="pre">env-mailserver</span></code> to your liking:<ul>
<li><code class="docutils literal notranslate"><span class="pre">.env</span></code> contains the configuration for docker-compose</li>
<li><code class="docutils literal notranslate"><span class="pre">env-mailserver</span></code> contains the configuration for the mailserver container</li>
<li>These files supports only simple <code class="docutils literal notranslate"><span class="pre">VAR=VAL</span></code> lines (see <a class="reference external" href="https://docs.docker.com/compose/env-file/">Documentation</a>).</li>
<li>Don’t quote your values.</li>
<li>Variable substitution is <em>not</em> supported (e.g. <code class="docutils literal notranslate"><span class="pre">OVERRIDE_HOSTNAME=$HOSTNAME.$DOMAINNAME</span></code>).</li>
</ul>
</li>
<li>Install <a class="reference external" href="https://docs.docker.com/compose/">docker-compose</a> in the version <code class="docutils literal notranslate"><span class="pre">1.7</span></code> or higher.</li>
</ul>
</div>
<div class="section" id="start-container">
<h3>Start Container<a class="headerlink" href="#start-container" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">mail</span>
</pre></div>
</div>
</div>
<div class="section" id="create-your-mail-accounts">
<h3>Create your mail accounts<a class="headerlink" href="#create-your-mail-accounts" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span> <span class="n">email</span> <span class="n">add</span> <span class="o">&lt;</span><span class="n">user</span><span class="nd">@domain</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-dkim-keys">
<h3>Generate DKIM keys<a class="headerlink" href="#generate-dkim-keys" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span> <span class="n">config</span> <span class="n">dkim</span>
</pre></div>
</div>
<p>Now the keys are generated, you can configure your DNS server by just pasting the content of <code class="docutils literal notranslate"><span class="pre">config/opendkim/keys/domain.tld/mail.txt</span></code> in your <code class="docutils literal notranslate"><span class="pre">domain.tld.hosts</span></code> zone.</p>
</div>
<div class="section" id="restart-and-update-the-container">
<h3>Restart and update the container<a class="headerlink" href="#restart-and-update-the-container" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">down</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">mail</span>
</pre></div>
</div>
<p>You’re done!</p>
<p>And don’t forget to have a look at the remaining functions of the <code class="docutils literal notranslate"><span class="pre">setup.sh</span></code> script</p>
</div>
<div class="section" id="spf-forwarding-problems">
<h3>SPF/Forwarding Problems<a class="headerlink" href="#spf-forwarding-problems" title="Permalink to this headline">¶</a></h3>
<p>If you got any problems with SPF and/or forwarding mails, give <a class="reference external" href="https://github.com/roehling/postsrsd/blob/master/README">SRS</a> a try. You enable SRS by setting <code class="docutils literal notranslate"><span class="pre">ENABLE_SRS=1</span></code>. See the variable description for further information.</p>
<p><code class="docutils literal notranslate"><span class="pre">restart:</span> <span class="pre">always</span></code> ensures that the mail server container (and Filebeat/ELK containers when using the mail server together with ELK stack) is automatically restarted by Docker in cases like a Docker service or host restart or container exit.</p>
<ol class="simple">
<li>A connection <em>may</em> be secured over TLS when both ends support <code class="docutils literal notranslate"><span class="pre">STARTTLS</span></code>. On ports 110, 143 and 587, <code class="docutils literal notranslate"><span class="pre">docker-mailserver</span></code> will reject a connection that cannot be secured. Port 25 is <a class="reference external" href="https://serverfault.com/questions/623692/is-it-still-wrong-to-require-starttls-on-incoming-smtp-messages">required</a> to support insecure connections.</li>
<li>Receives email and filters for spam and viruses. For submitting outgoing mail you should prefer the submission ports(465, 587), which require authentication. Unless a relay host is configured, outgoing email will leave the server via port 25(thus outbound traffic must not be blocked by your provider or firewall).</li>
<li>A submission port since 2018, <a class="reference external" href="https://tools.ietf.org/html/rfc8314">RFC 8314</a>. Originally a secure variant of port 25.</li>
</ol>
<div class="section" id="examples-with-just-the-relevant-environmental-variables">
<h4>Examples with just the relevant environmental variables:<a class="headerlink" href="#examples-with-just-the-relevant-environmental-variables" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">version</span><span class="p">:</span> <span class="s">&#39;2&#39;</span>

<span class="nt">services</span><span class="p">:</span>
  <span class="nt">mail</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">entrench/smtp:3.1.0.0</span>
    <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mail</span>
    <span class="nt">domainname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">domain.com</span>
    <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mail</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;25:25&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;143:143&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;587:587&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;993:993&quot;</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">maildata:/var/mail</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mailstate:/var/mail-state</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">maillogs:/var/log/mail</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./config/:/tmp/docker-mailserver/</span>
    <span class="nt">environment</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_SPAMASSASSIN=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SPAMASSASSIN_SPAM_TO_INBOX=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_CLAMAV=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_FAIL2BAN=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_POSTGREY=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ONE_DIR=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DMS_DEBUG=0</span>
    <span class="nt">cap_add</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NET_ADMIN</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SYS_PTRACE</span>

<span class="nt">volumes</span><span class="p">:</span>
  <span class="nt">maildata</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="nt">mailstate</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="nt">maillogs</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
</pre></div>
</div>
<p><strong>for ldap setup</strong>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">version</span><span class="p">:</span> <span class="s">&#39;2&#39;</span>

<span class="nt">services</span><span class="p">:</span>
  <span class="nt">mail</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">entrench/smtp:3.1.0.0</span>
    <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mail</span>
    <span class="nt">domainname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">domain.com</span>
    <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mail</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;25:25&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;143:143&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;587:587&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;993:993&quot;</span>
    <span class="nt">volumes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">maildata:/var/mail</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mailstate:/var/mail-state</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">maillogs:/var/log/mail</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./config/:/tmp/docker-mailserver/</span>
    <span class="nt">environment</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_SPAMASSASSIN=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SPAMASSASSIN_SPAM_TO_INBOX=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_CLAMAV=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_FAIL2BAN=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_POSTGREY=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ONE_DIR=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DMS_DEBUG=0</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_LDAP=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_SERVER_HOST=ldap</span> <span class="c1"># your ldap container/IP/ServerName</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_SEARCH_BASE=ou=people,dc=localhost,dc=localdomain</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_BIND_DN=cn=admin,dc=localhost,dc=localdomain</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_BIND_PW=admin</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_QUERY_FILTER_USER=(&amp;(mail=%s)(mailEnabled=TRUE))</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_QUERY_FILTER_GROUP=(&amp;(mailGroupMember=%s)(mailEnabled=TRUE))</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_QUERY_FILTER_ALIAS=(|(&amp;(mailAlias=%s)(objectClass=PostfixBookMailForward))(&amp;(mailAlias=%s)(objectClass=PostfixBookMailAccount)(mailEnabled=TRUE)))</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LDAP_QUERY_FILTER_DOMAIN=(|(&amp;(mail=*@%s)(objectClass=PostfixBookMailAccount)(mailEnabled=TRUE))(&amp;(mailGroupMember=*@%s)(objectClass=PostfixBookMailAccount)(mailEnabled=TRUE))(&amp;(mailalias=*@%s)(objectClass=PostfixBookMailForward)))</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DOVECOT_PASS_FILTER=(&amp;(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DOVECOT_USER_FILTER=(&amp;(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ENABLE_SASLAUTHD=1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SASLAUTHD_MECHANISMS=ldap</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SASLAUTHD_LDAP_SERVER=ldap</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SASLAUTHD_LDAP_BIND_DN=cn=admin,dc=localhost,dc=localdomain</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SASLAUTHD_LDAP_PASSWORD=admin</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SASLAUTHD_LDAP_SEARCH_BASE=ou=people,dc=localhost,dc=localdomain</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">POSTMASTER_ADDRESS=postmaster@localhost.localdomain</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">POSTFIX_MESSAGE_SIZE_LIMIT=100000000</span>
    <span class="nt">cap_add</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NET_ADMIN</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SYS_PTRACE</span>

<span class="nt">volumes</span><span class="p">:</span>
  <span class="nt">maildata</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="nt">mailstate</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="nt">maillogs</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dms-debug">
<h3>DMS_DEBUG<a class="headerlink" href="#dms-debug" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; Debug disabled</li>
<li>1 =&gt; Enables debug on startup</li>
</ul>
</div>
<div class="section" id="enable-clamav">
<h3>ENABLE_CLAMAV<a class="headerlink" href="#enable-clamav" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; Clamav is disabled</li>
<li>1 =&gt; Clamav is enabled</li>
</ul>
</div>
<div class="section" id="one-dir">
<h3>ONE_DIR<a class="headerlink" href="#one-dir" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; state in default directories</li>
<li>1 =&gt; consolidate all states into a single directory (<code class="docutils literal notranslate"><span class="pre">/var/mail-state</span></code>) to allow persistence using docker volumes</li>
</ul>
</div>
<div class="section" id="enable-pop3">
<h3>ENABLE_POP3<a class="headerlink" href="#enable-pop3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; POP3 service disabled</li>
<li>1 =&gt; Enables POP3 service</li>
</ul>
</div>
<div class="section" id="enable-fail2ban">
<h3>ENABLE_FAIL2BAN<a class="headerlink" href="#enable-fail2ban" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; fail2ban service disabled</li>
<li>1 =&gt; Enables fail2ban service</li>
</ul>
<p>If you enable Fail2Ban, don’t forget to add the following lines to your <code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cap_add</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">NET_ADMIN</span>
</pre></div>
</div>
<p>Otherwise, <code class="docutils literal notranslate"><span class="pre">iptables</span></code> won’t be able to ban IPs.</p>
</div>
<div class="section" id="smtp-only">
<h3>SMTP_ONLY<a class="headerlink" href="#smtp-only" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; all daemons start</li>
<li>1 =&gt; only launch postfix smtp</li>
</ul>
</div>
<div class="section" id="ssl-type">
<h3>SSL_TYPE<a class="headerlink" href="#ssl-type" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; SSL disabled</li>
<li>letsencrypt =&gt; Enables Let’s Encrypt certificates</li>
<li>custom =&gt; Enables custom certificates</li>
<li>manual =&gt; Let you manually specify locations of your SSL certificates for non-standard cases</li>
<li>self-signed =&gt; Enables self-signed certificates</li>
<li><em>any other value</em> =&gt; SSL required, settings by default</li>
</ul>
</div>
<div class="section" id="tls-level">
<h3>TLS_LEVEL<a class="headerlink" href="#tls-level" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; modern</li>
<li>modern =&gt; Enables TLSv1.2 and modern ciphers only. (default)</li>
<li>intermediate =&gt; Enables TLSv1, TLSv1.1 and TLSv1.2 and broad compatibility ciphers.</li>
<li>old =&gt; NOT implemented. If you really need it, then customize the TLS ciphers overriding postfix and dovecot settings.</li>
</ul>
</div>
<div class="section" id="spoof-protection">
<h3>SPOOF_PROTECTION<a class="headerlink" href="#spoof-protection" title="Permalink to this headline">¶</a></h3>
<p>Configures the handling of creating mails with forged sender addresses.</p>
<ul class="simple">
<li><strong>empty</strong> =&gt; Mail address spoofing allowed. Any logged in user may create email messages with a forged sender address. See also <a class="reference external" href="https://en.wikipedia.org/wiki/Email_spoofing">Wikipedia</a>(not recommended, but default for backwards compatibility reasons)</li>
<li>1 =&gt; (recommended) Mail spoofing denied. Each user may only send with his own or his alias addresses. Addresses with <a class="reference external" href="http://www.postfix.org/postconf.5.html#recipient_delimiter">extension delimiters</a> are not able to send messages.</li>
</ul>
</div>
<div class="section" id="enable-srs">
<h3>ENABLE_SRS<a class="headerlink" href="#enable-srs" title="Permalink to this headline">¶</a></h3>
<p>Enables the Sender Rewriting Scheme. SRS is needed if your mail server acts as forwarder. See <a class="reference external" href="https://github.com/roehling/postsrsd/blob/master/README.md#sender-rewriting-scheme-crash-course">postsrsd</a> for further explanation.</p>
<ul class="simple">
<li><strong>0</strong> =&gt; Disabled</li>
<li>1 =&gt; Enabled</li>
</ul>
</div>
<div class="section" id="permit-docker">
<h3>PERMIT_DOCKER<a class="headerlink" href="#permit-docker" title="Permalink to this headline">¶</a></h3>
<p>Set different options for mynetworks option (can be overwrite in postfix-main.cf) <strong>WARNING</strong>: Adding the docker network’s gateway to the list of trusted hosts, e.g. using the <code class="docutils literal notranslate"><span class="pre">network</span></code> or <code class="docutils literal notranslate"><span class="pre">connected-networks</span></code> option, can create an <a class="reference external" href="https://en.wikipedia.org/wiki/Open_mail_relay"><strong>open relay</strong></a>, if IPv6 is enabled on the host machine but not in Docker.</p>
<ul class="simple">
<li><strong>empty</strong> =&gt; localhost only</li>
<li>host =&gt; Add docker host (ipv4 only)</li>
<li>network =&gt; Add the docker default bridge network (172.16.0.0/12); <strong>WARNING</strong>: <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> might use others (e.g. 192.168.0.0/16) use <code class="docutils literal notranslate"><span class="pre">PERMIT_DOCKER=connected-networks</span></code> in this case</li>
<li>connected-networks =&gt; Add all connected docker networks (ipv4 only)</li>
</ul>
<p>Note: you probably want to <a class="reference external" href="#postfix_inet_protocols">set <code class="docutils literal notranslate"><span class="pre">POSTFIX_INET_PROTOCOLS=ipv4</span></code></a> to make it work fine with Docker.</p>
</div>
<div class="section" id="virusmails-delete-delay">
<h3>VIRUSMAILS_DELETE_DELAY<a class="headerlink" href="#virusmails-delete-delay" title="Permalink to this headline">¶</a></h3>
<p>Set how many days a virusmail will stay on the server before being deleted</p>
<ul class="simple">
<li><strong>empty</strong> =&gt; 7 days</li>
</ul>
</div>
<div class="section" id="enable-postfix-virtual-transport">
<h3>ENABLE_POSTFIX_VIRTUAL_TRANSPORT<a class="headerlink" href="#enable-postfix-virtual-transport" title="Permalink to this headline">¶</a></h3>
<p>This Option is activating the Usage of POSTFIX_DAGENT to specify a ltmp client different from default dovecot socket.</p>
<ul class="simple">
<li><strong>empty</strong> =&gt; disabled</li>
<li>1 =&gt; enabled</li>
</ul>
</div>
<div class="section" id="postfix-dagent">
<h3>POSTFIX_DAGENT<a class="headerlink" href="#postfix-dagent" title="Permalink to this headline">¶</a></h3>
<p>Enabled by ENABLE_POSTFIX_VIRTUAL_TRANSPORT. Specify the final delivery of postfix</p>
<ul class="simple">
<li><strong>empty</strong>: fail</li>
<li><code class="docutils literal notranslate"><span class="pre">lmtp:unix:private/dovecot-lmtp</span></code> (use socket)</li>
<li><code class="docutils literal notranslate"><span class="pre">lmtps:inet:&lt;host&gt;:&lt;port&gt;</span></code> (secure lmtp with starttls, take a look at https://sys4.de/en/blog/2014/11/17/sicheres-lmtp-mit-starttls-in-dovecot/)</li>
<li><code class="docutils literal notranslate"><span class="pre">lmtp:&lt;kopano-host&gt;:2003</span></code> (use kopano as mailstore)</li>
<li>etc.</li>
</ul>
</div>
<div class="section" id="postfix-mailbox-size-limit">
<h3>POSTFIX_MAILBOX_SIZE_LIMIT<a class="headerlink" href="#postfix-mailbox-size-limit" title="Permalink to this headline">¶</a></h3>
<p>Set the mailbox size limit for all users. If set to zero, the size will be unlimited (default).</p>
<ul class="simple">
<li><strong>empty</strong> =&gt; 0 (no limit)</li>
</ul>
</div>
<div class="section" id="enable-quotas">
<h3>ENABLE_QUOTAS<a class="headerlink" href="#enable-quotas" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>1</strong> =&gt; Dovecot quota is enabled</li>
<li>0 =&gt; Dovecot quota is disabled</li>
</ul>
</div>
<div class="section" id="postfix-message-size-limit">
<h3>POSTFIX_MESSAGE_SIZE_LIMIT<a class="headerlink" href="#postfix-message-size-limit" title="Permalink to this headline">¶</a></h3>
<p>Set the message size limit for all users. If set to zero, the size will be unlimited (not recommended!)</p>
<ul class="simple">
<li><strong>empty</strong> =&gt; 10240000 (~10 MB)</li>
</ul>
</div>
<div class="section" id="enable-managesieve">
<h3>ENABLE_MANAGESIEVE<a class="headerlink" href="#enable-managesieve" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; Managesieve service disabled</li>
<li>1 =&gt; Enables Managesieve on port 4190</li>
</ul>
</div>
<div class="section" id="override-hostname">
<h3>OVERRIDE_HOSTNAME<a class="headerlink" href="#override-hostname" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; uses the <code class="docutils literal notranslate"><span class="pre">hostname</span></code> command to get the mail server’s canonical hostname</li>
<li>=&gt; Specify a fully-qualified domainname to serve mail for.  This is used for many of the config features so if you can’t set your hostname (e.g. you’re in a container platform that doesn’t let you) specify it in this environment variable.</li>
</ul>
</div>
<div class="section" id="postmaster-address">
<h3>POSTMASTER_ADDRESS<a class="headerlink" href="#postmaster-address" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; postmaster&#64;domain.com</li>
<li>=&gt; Specify the postmaster address</li>
</ul>
</div>
<div class="section" id="postscreen-action">
<h3>POSTSCREEN_ACTION<a class="headerlink" href="#postscreen-action" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>enforce</strong> =&gt; Allow other tests to complete. Reject attempts to deliver mail with a 550 SMTP reply, and log the helo/sender/recipient information. Repeat this test the next time the client connects.</li>
<li>drop =&gt; Drop the connection immediately with a 521 SMTP reply. Repeat this test the next time the client connects.</li>
<li>ignore =&gt; Ignore the failure of this test. Allow other tests to complete. Repeat this test the next time the client connects. This option is useful for testing and collecting statistics without blocking mail.</li>
</ul>
</div>
<div class="section" id="dovecot-mailbox-format">
<h3>DOVECOT_MAILBOX_FORMAT<a class="headerlink" href="#dovecot-mailbox-format" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>maildir</strong> =&gt; uses very common Maildir format, one file contains one message</li>
<li>sdbox =&gt; (experimental) uses Dovecot high-performance mailbox format, one file contains one message</li>
<li>mdbox ==&gt; (experimental) uses Dovecot high-performance mailbox format, multiple messages per file and multiple files per box</li>
</ul>
<p>This option has been added in November 2019. Using other format than Maildir is considered as experimental in docker-mailserver and should only be used for testing purpose. For more details, please refer to <a class="reference external" href="https://wiki2.dovecot.org/MailboxFormat">Dovecot Documentation</a>.</p>
</div>
<div class="section" id="postfix-inet-protocols">
<h3>POSTFIX_INET_PROTOCOLS<a class="headerlink" href="#postfix-inet-protocols" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>all</strong> =&gt; All possible protocols.</li>
<li>ipv4 =&gt; Use only IPv4 traffic. Most likely you want this behind Docker.</li>
<li>ipv6 =&gt; Use only IPv6 traffic.</li>
</ul>
<p>Note: More details in http://www.postfix.org/postconf.5.html#inet_protocols</p>
</div>
</div>
<div class="section" id="reports">
<h2>Reports<a class="headerlink" href="#reports" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pflogsumm-trigger">
<h3>PFLOGSUMM_TRIGGER<a class="headerlink" href="#pflogsumm-trigger" title="Permalink to this headline">¶</a></h3>
<p>Enables regular pflogsumm mail reports.</p>
<ul class="simple">
<li><strong>not set</strong> =&gt; No report</li>
<li>daily_cron =&gt; Daily report for the previous day</li>
<li>logrotate =&gt; Full report based on the mail log when it is rotated</li>
</ul>
<p>This is a new option. The old REPORT options are still supported for backwards compatibility.
If this is not set and reports are enabled with the old options, logrotate will be used.</p>
</div>
<div class="section" id="pflogsumm-recipient">
<h3>PFLOGSUMM_RECIPIENT<a class="headerlink" href="#pflogsumm-recipient" title="Permalink to this headline">¶</a></h3>
<p>Recipient address for pflogsumm reports.</p>
<ul class="simple">
<li><strong>not set</strong> =&gt; Use REPORT_RECIPIENT or POSTMASTER_ADDRESS</li>
<li>=&gt; Specify the recipient address(es)</li>
</ul>
</div>
<div class="section" id="pflogsumm-sender">
<h3>PFLOGSUMM_SENDER<a class="headerlink" href="#pflogsumm-sender" title="Permalink to this headline">¶</a></h3>
<p>From address for pflogsumm reports.</p>
<ul class="simple">
<li><strong>not set</strong> =&gt; Use REPORT_SENDER or POSTMASTER_ADDRESS</li>
<li>=&gt; Specify the sender address</li>
</ul>
</div>
<div class="section" id="logwatch-interval">
<h3>LOGWATCH_INTERVAL<a class="headerlink" href="#logwatch-interval" title="Permalink to this headline">¶</a></h3>
<p>Interval for logwatch report.</p>
<ul class="simple">
<li><strong>none</strong> =&gt; No report is generated</li>
<li>daily =&gt; Send a daily report</li>
<li>weekly =&gt; Send a report every week</li>
</ul>
</div>
<div class="section" id="logwatch-recipient">
<h3>LOGWATCH_RECIPIENT<a class="headerlink" href="#logwatch-recipient" title="Permalink to this headline">¶</a></h3>
<p>Recipient address for logwatch reports if they are enabled.</p>
<ul class="simple">
<li><strong>not set</strong> =&gt; Use REPORT_RECIPIENT or POSTMASTER_ADDRESS</li>
<li>=&gt; Specify the recipient address(es)</li>
</ul>
</div>
<div class="section" id="report-recipient-deprecated">
<h3>REPORT_RECIPIENT (deprecated)<a class="headerlink" href="#report-recipient-deprecated" title="Permalink to this headline">¶</a></h3>
<p>Enables a report being sent (created by pflogsumm) on a regular basis.</p>
<ul class="simple">
<li><strong>0</strong> =&gt; Report emails are disabled unless enabled by other options</li>
<li>1 =&gt; Using POSTMASTER_ADDRESS as the recipient</li>
<li>=&gt; Specify the recipient address</li>
</ul>
</div>
<div class="section" id="report-sender-deprecated">
<h3>REPORT_SENDER (deprecated)<a class="headerlink" href="#report-sender-deprecated" title="Permalink to this headline">¶</a></h3>
<p>Change the sending address for mail report</p>
<ul class="simple">
<li><strong>empty</strong> =&gt; mailserver-report&#64;hostname</li>
<li>=&gt; Specify the report sender (From) address</li>
</ul>
</div>
<div class="section" id="report-interval-deprecated">
<h3>REPORT_INTERVAL (deprecated)<a class="headerlink" href="#report-interval-deprecated" title="Permalink to this headline">¶</a></h3>
<p>changes the interval in which logs are rotated and a report is being sent (deprecated).</p>
<ul class="simple">
<li><strong>daily</strong> =&gt; Send a daily report</li>
<li>weekly =&gt; Send a report every week</li>
<li>monthly =&gt; Send a report every month</li>
</ul>
<p>Note: This variable used to control logrotate inside the container and sent the pflogsumm report when the logs were rotated.
It is still supported for backwards compatibility, but the new option LOGROTATE_INTERVAL has been added that only rotates
the logs.</p>
</div>
<div class="section" id="logrotate-interval">
<h3>LOGROTATE_INTERVAL<a class="headerlink" href="#logrotate-interval" title="Permalink to this headline">¶</a></h3>
<p>Defines the interval in which the mail log is being rotated.</p>
<ul class="simple">
<li><strong>daily</strong> =&gt; Rotate daily.</li>
<li>weekly =&gt; Rotate weekly.</li>
<li>monthly =&gt; Rotate monthly.</li>
</ul>
<p>Note that only the log inside the container is affected.
The full log output is still available via <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">logs</span> <span class="pre">mail</span></code> (or your respective container name).
If you want to control logrotation for the docker generated logfile see: <a class="reference external" href="https://docs.docker.com/config/containers/logging/configure/">Docker Logging Drivers</a>.</p>
<p>Also note that by default the logs are lost when the container is recycled. To keep the logs, mount a volume.</p>
<p>Finally the logrotate interval <strong>may</strong> affect the period for generated reports. That is the case when the reports are triggered by log rotation.</p>
</div>
</div>
<div class="section" id="spamassassin">
<h2>Spamassassin<a class="headerlink" href="#spamassassin" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enable-spamassassin">
<h3>ENABLE_SPAMASSASSIN<a class="headerlink" href="#enable-spamassassin" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; Spamassassin is disabled</li>
<li>1 =&gt; Spamassassin is enabled</li>
</ul>
<p><strong>/!\ Spam delivery:</strong> when Spamassassin is enabled, messages marked as spam WILL NOT BE DELIVERED.
Use <code class="docutils literal notranslate"><span class="pre">SPAMASSASSIN_SPAM_TO_INBOX=1</span></code> for receiving spam messages.</p>
</div>
<div class="section" id="spamassassin-spam-to-inbox">
<h3>SPAMASSASSIN_SPAM_TO_INBOX<a class="headerlink" href="#spamassassin-spam-to-inbox" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; Spam messages will be bounced (<em>rejected</em>) without any notification (<em>dangerous</em>).</li>
<li>1 =&gt; Spam messages will be delivered to the inbox and tagged as spam using <code class="docutils literal notranslate"><span class="pre">SA_SPAM_SUBJECT</span></code>.</li>
</ul>
</div>
<div class="section" id="move-spam-to-junk">
<h3>MOVE_SPAM_TO_JUNK<a class="headerlink" href="#move-spam-to-junk" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>1</strong> =&gt; Spam messages will be delivered in the <code class="docutils literal notranslate"><span class="pre">Junk</span></code> folder.</li>
<li>0 =&gt; Spam messages will be delivered in the mailbox.</li>
</ul>
<p>Note: this setting needs <code class="docutils literal notranslate"><span class="pre">SPAMASSASSIN_SPAM_TO_INBOX=1</span></code></p>
</div>
<div class="section" id="sa-tag">
<h3>SA_TAG<a class="headerlink" href="#sa-tag" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>2.0</strong> =&gt; add spam info headers if at, or above that level</li>
</ul>
<p>Note: this spamassassin setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_SPAMASSASSIN=1</span></code></p>
</div>
<div class="section" id="sa-tag2">
<h3>SA_TAG2<a class="headerlink" href="#sa-tag2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>6.31</strong> =&gt; add ‘spam detected’ headers at that level</li>
</ul>
<p>Note: this spamassassin setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_SPAMASSASSIN=1</span></code></p>
</div>
<div class="section" id="sa-kill">
<h3>SA_KILL<a class="headerlink" href="#sa-kill" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>6.31</strong> =&gt; triggers spam evasive actions</li>
</ul>
<p>Note: this spamassassin setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_SPAMASSASSIN=1</span></code>. By default, the mailserver is configured to quarantine spam emails. If emails are quarantined, they are compressed and stored in a location dependent on the ONE_DIR setting above. If <code class="docutils literal notranslate"><span class="pre">ONE_DIR=1</span></code> the location is /var/mail-state/lib-amavis/virusmails/. If <code class="docutils literal notranslate"><span class="pre">ONE_DIR=0</span></code> it is /var/lib/amavis/virusmails/. These paths are inside the docker container. To inhibit this behaviour and deliver spam emails, set this to a very high value e.g. 100.0.</p>
</div>
<div class="section" id="sa-spam-subject">
<h3>SA_SPAM_SUBJECT<a class="headerlink" href="#sa-spam-subject" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>***SPAM***</strong> =&gt; add tag to subject if spam detected</li>
</ul>
<p>Note: this spamassassin setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_SPAMASSASSIN=1</span></code></p>
</div>
<div class="section" id="sa-shortcircuit-bayes-spam">
<h3>SA_SHORTCIRCUIT_BAYES_SPAM<a class="headerlink" href="#sa-shortcircuit-bayes-spam" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>1</strong> =&gt; will activate spamassassin short circuiting for bayes spam detection.</li>
</ul>
<p>This will uncomment the respective line in <code class="docutils literal notranslate"><span class="pre">/etc/spamassasin/local.cf</span></code></p>
<p>Note: activate this only if you are confident in your bayes database for identifying spam.</p>
</div>
<div class="section" id="sa-shortcircuit-bayes-ham">
<h3>SA_SHORTCIRCUIT_BAYES_HAM<a class="headerlink" href="#sa-shortcircuit-bayes-ham" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>1</strong> =&gt; will activate spamassassin short circuiting for bayes ham detection</li>
</ul>
<p>This will uncomment the respective line in <code class="docutils literal notranslate"><span class="pre">/etc/spamassasin/local.cf</span></code></p>
<p>Note: activate this only if you are confident in your bayes database for identifying ham.</p>
</div>
</div>
<div class="section" id="fetchmail">
<h2>Fetchmail<a class="headerlink" href="#fetchmail" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enable-fetchmail">
<h3>ENABLE_FETCHMAIL<a class="headerlink" href="#enable-fetchmail" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; <code class="docutils literal notranslate"><span class="pre">fetchmail</span></code> disabled</li>
<li>1 =&gt; <code class="docutils literal notranslate"><span class="pre">fetchmail</span></code> enabled</li>
</ul>
</div>
<div class="section" id="fetchmail-poll">
<h3>FETCHMAIL_POLL<a class="headerlink" href="#fetchmail-poll" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>300</strong> =&gt; <code class="docutils literal notranslate"><span class="pre">fetchmail</span></code> The number of seconds for the interval</li>
</ul>
</div>
</div>
<div class="section" id="ldap">
<h2>LDAP<a class="headerlink" href="#ldap" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enable-ldap">
<h3>ENABLE_LDAP<a class="headerlink" href="#enable-ldap" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; LDAP authentification is disabled</li>
<li>1 =&gt; LDAP authentification is enabled</li>
<li>NOTE:<ul>
<li>A second container for the ldap service is necessary (e.g. <a class="reference external" href="https://github.com/osixia/docker-openldap">docker-openldap</a>)</li>
<li>For preparing the ldap server to use in combination with this container <a class="reference external" href="http://acidx.net/wordpress/2014/06/installing-a-mailserver-with-postfix-dovecot-sasl-ldap-roundcube/">this</a> article may be helpful</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="ldap-start-tls">
<h3>LDAP_START_TLS<a class="headerlink" href="#ldap-start-tls" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; no</li>
<li>yes =&gt; LDAP over TLS enabled for Postfix</li>
</ul>
</div>
<div class="section" id="ldap-server-host">
<h3>LDAP_SERVER_HOST<a class="headerlink" href="#ldap-server-host" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; mail.domain.com</li>
<li>=&gt; Specify the dns-name/ip-address where the ldap-server</li>
<li>NOTE: If you going to use the mailserver in combination with docker-compose you can set the service name here</li>
</ul>
</div>
<div class="section" id="ldap-search-base">
<h3>LDAP_SEARCH_BASE<a class="headerlink" href="#ldap-search-base" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; ou=people,dc=domain,dc=com</li>
<li>=&gt; e.g. LDAP_SEARCH_BASE=dc=mydomain,dc=local</li>
</ul>
</div>
<div class="section" id="ldap-bind-dn">
<h3>LDAP_BIND_DN<a class="headerlink" href="#ldap-bind-dn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; cn=admin,dc=domain,dc=com</li>
<li>=&gt; take a look at examples of SASL_LDAP_BIND_DN</li>
</ul>
</div>
<div class="section" id="ldap-bind-pw">
<h3>LDAP_BIND_PW<a class="headerlink" href="#ldap-bind-pw" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; admin</li>
<li>=&gt; Specify the password to bind against ldap</li>
</ul>
</div>
<div class="section" id="ldap-query-filter-user">
<h3>LDAP_QUERY_FILTER_USER<a class="headerlink" href="#ldap-query-filter-user" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">(&amp;(mail=%s)(mailEnabled=TRUE))</span></code></li>
<li>=&gt; Specify how ldap should be asked for users</li>
</ul>
</div>
<div class="section" id="ldap-query-filter-group">
<h3>LDAP_QUERY_FILTER_GROUP<a class="headerlink" href="#ldap-query-filter-group" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">(&amp;(mailGroupMember=%s)(mailEnabled=TRUE))</span></code></li>
<li>=&gt; Specify how ldap should be asked for groups</li>
</ul>
</div>
<div class="section" id="ldap-query-filter-alias">
<h3>LDAP_QUERY_FILTER_ALIAS<a class="headerlink" href="#ldap-query-filter-alias" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">(&amp;(mailAlias=%s)(mailEnabled=TRUE))</span></code></li>
<li>=&gt; Specify how ldap should be asked for aliases</li>
</ul>
</div>
<div class="section" id="ldap-query-filter-domain">
<h3>LDAP_QUERY_FILTER_DOMAIN<a class="headerlink" href="#ldap-query-filter-domain" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">(&amp;(|(mail=*&#64;%s)(mailalias=*&#64;%s)(mailGroupMember=*&#64;%s))(mailEnabled=TRUE))</span></code></li>
<li>=&gt; Specify how ldap should be asked for domains</li>
</ul>
</div>
<div class="section" id="dovecot-tls">
<h3>DOVECOT_TLS<a class="headerlink" href="#dovecot-tls" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; no</li>
<li>yes =&gt; LDAP over TLS enabled for Dovecot</li>
</ul>
</div>
</div>
<div class="section" id="dovecot">
<h2>Dovecot<a class="headerlink" href="#dovecot" title="Permalink to this headline">¶</a></h2>
<p>The following variables overwrite the default values for <code class="docutils literal notranslate"><span class="pre">/etc/dovecot/dovecot-ldap.conf.ext</span></code>.</p>
<div class="section" id="dovecot-user-filter">
<h3>DOVECOT_USER_FILTER<a class="headerlink" href="#dovecot-user-filter" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">(&amp;(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))</span></code></li>
</ul>
</div>
<div class="section" id="dovecot-user-attrs">
<h3>DOVECOT_USER_ATTRS<a class="headerlink" href="#dovecot-user-attrs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">homeDirectory=home,qmailUID=uid,qmailGID=gid,mailMessageStore=mail</span></code></li>
<li>=&gt; Specify the directory to dovecot attribute mapping that fits your directory structure.</li>
<li>Note: This is necessary for directories that do not use the <a class="reference external" href="test/docker-openldap/bootstrap/schema/mmc/postfix-book.schema">Postfix Book Schema</a>.</li>
<li>Note: The left-hand value is the directory attribute, the right hand value is the dovecot variable.</li>
<li>More details on the <a class="reference external" href="https://wiki.dovecot.org/AuthDatabase/LDAP/Userdb">Dovecot Wiki</a></li>
</ul>
</div>
<div class="section" id="dovecot-pass-filter">
<h3>DOVECOT_PASS_FILTER<a class="headerlink" href="#dovecot-pass-filter" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">(&amp;(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))</span></code></li>
</ul>
</div>
<div class="section" id="dovecot-pass-attrs">
<h3>DOVECOT_PASS_ATTRS<a class="headerlink" href="#dovecot-pass-attrs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>e.g. <code class="docutils literal notranslate"><span class="pre">uid=user,userPassword=password</span></code></li>
<li>=&gt; Specify the directory to dovecot variable mapping that fits your directory structure.</li>
<li>Note: This is necessary for directories that do not use the <a class="reference external" href="test/docker-openldap/bootstrap/schema/mmc/postfix-book.schema">Postfix Book Schema</a>.</li>
<li>Note: The left-hand value is the directory attribute, the right hand value is the dovecot variable.</li>
<li>More details on the <a class="reference external" href="https://wiki.dovecot.org/AuthDatabase/LDAP/PasswordLookups">Dovecot Wiki</a></li>
</ul>
</div>
</div>
<div class="section" id="postgrey">
<h2>Postgrey<a class="headerlink" href="#postgrey" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enable-postgrey">
<h3>ENABLE_POSTGREY<a class="headerlink" href="#enable-postgrey" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; <code class="docutils literal notranslate"><span class="pre">postgrey</span></code> is disabled</li>
<li>1 =&gt; <code class="docutils literal notranslate"><span class="pre">postgrey</span></code> is enabled</li>
</ul>
</div>
<div class="section" id="postgrey-delay">
<h3>POSTGREY_DELAY<a class="headerlink" href="#postgrey-delay" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>300</strong> =&gt; greylist for N seconds</li>
</ul>
<p>Note: This postgrey setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_POSTGREY=1</span></code></p>
</div>
<div class="section" id="postgrey-max-age">
<h3>POSTGREY_MAX_AGE<a class="headerlink" href="#postgrey-max-age" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>35</strong> =&gt; delete entries older than N days since the last time that they have been seen</li>
</ul>
<p>Note: This postgrey setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_POSTGREY=1</span></code></p>
</div>
<div class="section" id="postgrey-auto-whitelist-clients">
<h3>POSTGREY_AUTO_WHITELIST_CLIENTS<a class="headerlink" href="#postgrey-auto-whitelist-clients" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>5</strong> =&gt; whitelist host after N successful deliveries (N=0 to disable whitelisting)</li>
</ul>
<p>Note: This postgrey setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_POSTGREY=1</span></code></p>
</div>
<div class="section" id="postgrey-text">
<h3>POSTGREY_TEXT<a class="headerlink" href="#postgrey-text" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Delayed by postgrey</strong> =&gt; response when a mail is greylisted</li>
</ul>
<p>Note: This postgrey setting needs <code class="docutils literal notranslate"><span class="pre">ENABLE_POSTGREY=1</span></code></p>
</div>
</div>
<div class="section" id="sasl-auth">
<h2>SASL Auth<a class="headerlink" href="#sasl-auth" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enable-saslauthd">
<h3>ENABLE_SASLAUTHD<a class="headerlink" href="#enable-saslauthd" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>0</strong> =&gt; <code class="docutils literal notranslate"><span class="pre">saslauthd</span></code> is disabled</li>
<li>1 =&gt; <code class="docutils literal notranslate"><span class="pre">saslauthd</span></code> is enabled</li>
</ul>
</div>
<div class="section" id="saslauthd-mechanisms">
<h3>SASLAUTHD_MECHANISMS<a class="headerlink" href="#saslauthd-mechanisms" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty =&gt; pam</li>
<li><code class="docutils literal notranslate"><span class="pre">ldap</span></code> =&gt; authenticate against ldap server</li>
<li><code class="docutils literal notranslate"><span class="pre">shadow</span></code> =&gt; authenticate against local user db</li>
<li><code class="docutils literal notranslate"><span class="pre">mysql</span></code> =&gt; authenticate against mysql db</li>
<li><code class="docutils literal notranslate"><span class="pre">rimap</span></code> =&gt; authenticate against imap server</li>
<li>NOTE: can be a list of mechanisms like pam ldap shadow</li>
</ul>
</div>
<div class="section" id="saslauthd-mech-options">
<h3>SASLAUTHD_MECH_OPTIONS<a class="headerlink" href="#saslauthd-mech-options" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty =&gt; None</li>
<li>e.g. with SASLAUTHD_MECHANISMS rimap you need to specify the ip-address/servername of the imap server  ==&gt; xxx.xxx.xxx.xxx</li>
</ul>
</div>
<div class="section" id="saslauthd-ldap-server">
<h3>SASLAUTHD_LDAP_SERVER<a class="headerlink" href="#saslauthd-ldap-server" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty =&gt; localhost</li>
</ul>
</div>
<div class="section" id="saslauthd-ldap-ssl">
<h3>SASLAUTHD_LDAP_SSL<a class="headerlink" href="#saslauthd-ldap-ssl" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty or 0 =&gt; <code class="docutils literal notranslate"><span class="pre">ldap://</span></code> will be used</li>
<li>1 =&gt; <code class="docutils literal notranslate"><span class="pre">ldaps://</span></code> will be used</li>
</ul>
</div>
<div class="section" id="saslauthd-ldap-bind-dn">
<h3>SASLAUTHD_LDAP_BIND_DN<a class="headerlink" href="#saslauthd-ldap-bind-dn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty =&gt; anonymous bind</li>
<li>specify an object with privileges to search the directory tree</li>
<li>e.g. active directory: SASLAUTHD_LDAP_BIND_DN=cn=Administrator,cn=Users,dc=mydomain,dc=net</li>
<li>e.g. openldap: SASLAUTHD_LDAP_BIND_DN=cn=admin,dc=mydomain,dc=net</li>
</ul>
</div>
<div class="section" id="saslauthd-ldap-password">
<h3>SASLAUTHD_LDAP_PASSWORD<a class="headerlink" href="#saslauthd-ldap-password" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty =&gt; anonymous bind</li>
</ul>
</div>
<div class="section" id="saslauthd-ldap-search-base">
<h3>SASLAUTHD_LDAP_SEARCH_BASE<a class="headerlink" href="#saslauthd-ldap-search-base" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty =&gt; Reverting to SASLAUTHD_MECHANISMS pam</li>
<li>specify the search base</li>
</ul>
</div>
<div class="section" id="saslauthd-ldap-filter">
<h3>SASLAUTHD_LDAP_FILTER<a class="headerlink" href="#saslauthd-ldap-filter" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>empty =&gt; default filter <code class="docutils literal notranslate"><span class="pre">(&amp;(uniqueIdentifier=%u)(mailEnabled=TRUE))</span></code></li>
<li>e.g. for active directory: <code class="docutils literal notranslate"><span class="pre">(&amp;(sAMAccountName=%U)(objectClass=person))</span></code></li>
<li>e.g. for openldap: <code class="docutils literal notranslate"><span class="pre">(&amp;(uid=%U)(objectClass=person))</span></code></li>
</ul>
</div>
<div class="section" id="sasl-passwd">
<h3>SASL_PASSWD<a class="headerlink" href="#sasl-passwd" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; No sasl_passwd will be created</li>
<li>string =&gt; <code class="docutils literal notranslate"><span class="pre">/etc/postfix/sasl_passwd</span></code> will be created with the string as password</li>
</ul>
</div>
</div>
<div class="section" id="srs-sender-rewriting-scheme">
<h2>SRS (Sender Rewriting Scheme)<a class="headerlink" href="#srs-sender-rewriting-scheme" title="Permalink to this headline">¶</a></h2>
<div class="section" id="srs-sender-classes">
<h3>SRS_SENDER_CLASSES<a class="headerlink" href="#srs-sender-classes" title="Permalink to this headline">¶</a></h3>
<p>An email has an “envelope” sender (indicating the sending server) and a
“header” sender (indicating who sent it). More strict SPF policies may require
you to replace both instead of just the envelope sender.</p>
<p><a class="reference external" href="https://www.mybluelinux.com/what-is-email-envelope-and-email-header/">More info</a>.</p>
<ul class="simple">
<li><strong>envelope_sender</strong> =&gt; Rewrite only envelope sender address</li>
<li>header_sender =&gt; Rewrite only header sender (not recommended)</li>
<li>envelope_sender,header_sender =&gt; Rewrite both senders</li>
</ul>
</div>
<div class="section" id="srs-exclude-domains">
<h3>SRS_EXCLUDE_DOMAINS<a class="headerlink" href="#srs-exclude-domains" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; Envelope sender will be rewritten for all domains</li>
<li>provide comma separated list of domains to exclude from rewriting</li>
</ul>
</div>
<div class="section" id="srs-secret">
<h3>SRS_SECRET<a class="headerlink" href="#srs-secret" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; generated when the container is started for the first time</li>
<li>provide a secret to use in base64</li>
<li>you may specify multiple keys, comma separated. the first one is used for signing and the remaining will be used for verification. this is how you rotate and expire keys</li>
<li>if you have a cluster/swarm make sure the same keys are on all nodes</li>
<li>example command to generate a key: <code class="docutils literal notranslate"><span class="pre">dd</span> <span class="pre">if=/dev/urandom</span> <span class="pre">bs=24</span> <span class="pre">count=1</span> <span class="pre">2&gt;/dev/null</span> <span class="pre">|</span> <span class="pre">base64</span></code></li>
</ul>
</div>
<div class="section" id="srs-domainname">
<h3>SRS_DOMAINNAME<a class="headerlink" href="#srs-domainname" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; Derived from OVERRIDE_HOSTNAME, DOMAINNAME, or the container’s hostname</li>
<li>Set this if auto-detection fails, isn’t what you want, or you wish to have a separate container handle DSNs</li>
</ul>
</div>
</div>
<div class="section" id="default-relay-host">
<h2>Default Relay Host<a class="headerlink" href="#default-relay-host" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>DEFAULT_RELAY_HOST<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; don’t set default relayhost setting in main.cf</li>
<li>default host and port to relay all mail through.
Format: <code class="docutils literal notranslate"><span class="pre">[example.com]:587</span></code> (don’t forget the brackets if you need this to
be compatible with <code class="docutils literal notranslate"><span class="pre">$RELAY_USER</span></code> and <code class="docutils literal notranslate"><span class="pre">$RELAY_PASSWORD</span></code>, explained below).</li>
</ul>
</div>
</div>
<div class="section" id="multi-domain-relay-hosts">
<h2>Multi-domain Relay Hosts<a class="headerlink" href="#multi-domain-relay-hosts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="relay-host">
<h3>RELAY_HOST<a class="headerlink" href="#relay-host" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; don’t configure relay host</li>
<li>default host to relay mail through</li>
</ul>
</div>
<div class="section" id="relay-port">
<h3>RELAY_PORT<a class="headerlink" href="#relay-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; 25</li>
<li>default port to relay mail through</li>
</ul>
</div>
<div class="section" id="relay-user">
<h3>RELAY_USER<a class="headerlink" href="#relay-user" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; no default</li>
<li>default relay username (if no specific entry exists in postfix-sasl-password.cf)</li>
</ul>
</div>
<div class="section" id="relay-password">
<h3>RELAY_PASSWORD<a class="headerlink" href="#relay-password" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>empty</strong> =&gt; no default</li>
<li>password for default relay user</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../sizing/sizing.html" class="btn btn-neutral float-right" title="ZiSoft Awareness HW Sizing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../admin_guide/admin_guide.html" class="btn btn-neutral float-left" title="Initial Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Entrench
      <span class="lastupdated">
        Last updated on 2020-Jul-14.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>